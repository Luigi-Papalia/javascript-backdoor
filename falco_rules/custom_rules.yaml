- rule: Unexpected File Write During Package Install
  desc: Detects if any source file in the repo is modified during install/build
  condition: >
    evt.type in (open, openat, creat) and
    evt.arg.flags contains O_WRONLY and
    fd.name startswith "/workspace" and
    fd.type = "file" and
    proc.name in (npm, node, bash, sh, yarn) and
    not fd.name pmatch ("*/node_modules/*", "*.log")
  output: >
    Suspicious write by '{{proc.name}}' to '{{fd.name}}' during build/install
  priority: WARNING
  tags: [supply-chain, js, build]


- rule: Always Trigger Rule
  desc: This rule is for testing purposes and will always trigger.
  condition: always_true
  output: "Falco Test Alert: This is a forced trigger for CI/CD test detection"
  priority: WARNING
  tags: [test, ci, github-actions]