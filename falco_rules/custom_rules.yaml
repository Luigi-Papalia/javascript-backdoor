- required_engine_version: 0.39.0

- rule: JS Sandbox Source Write
  desc: >
    Detect any write‑open to files inside /home/runner/work/javascript-backdoor/javascript-backdoor 
    originating from processes under the same path, excluding node_modules and package-lock.json.
  condition: >
    open_write and
    fd.directory startswith "/home/runner/work/javascript-backdoor/javascript-backdoor" and
    not fd.directory contains "/node_modules/" and
    fd.name != "package-lock.json"
  output: >
    JS‑sandbox write detected! %proc.name (%proc.cmdline) opened %fd.name for write  
    (user=%user.name uid=%user.uid proc_exepath=%proc.exepath fd.directory=%fd.directory)
  priority: WARNING
  tags: [CI/CD, security]
